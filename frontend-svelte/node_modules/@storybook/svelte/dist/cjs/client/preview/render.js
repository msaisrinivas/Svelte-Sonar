"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.render = void 0;
exports.renderToDOM = renderToDOM;

require("core-js/modules/es.function.name.js");

var _global = _interopRequireDefault(require("global"));

var _PreviewRender = _interopRequireDefault(require("@storybook/svelte/templates/PreviewRender.svelte"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// eslint-disable-next-line import/no-extraneous-dependencies
var document = _global.default.document;
var previousComponent = null;

function cleanUpPreviousStory() {
  if (!previousComponent) {
    return;
  }

  previousComponent.$destroy();
  previousComponent = null;
}

function renderToDOM(_ref, domElement) {
  var storyFn = _ref.storyFn,
      kind = _ref.kind,
      name = _ref.name,
      showMain = _ref.showMain,
      showError = _ref.showError;
  cleanUpPreviousStory();
  var target = document.getElementById('root');
  target.innerHTML = '';
  previousComponent = new _PreviewRender.default({
    target: target,
    props: {
      storyFn: storyFn,
      name: name,
      kind: kind,
      showError: showError
    }
  });
  showMain();
}

var render = function render(args, context) {
  var id = context.id,
      Component = context.component;

  if (!Component) {
    throw new Error("Unable to render story ".concat(id, " as the component annotation is missing from the default export"));
  }

  return {
    Component: Component,
    props: args
  };
};

exports.render = render;