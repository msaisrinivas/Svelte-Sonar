"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.extractId = extractId;

var _clientLogger = require("@storybook/client-logger");

function hashCode(str) {
  var h = str.split('') // eslint-disable-next-line no-bitwise
  .reduce(function (prevHash, currVal) {
    return (prevHash << 5) - prevHash + currVal.charCodeAt(0) | 0;
  }, 0);
  return Math.abs(h).toString(16);
} // extract a story id


function extractId(_ref) {
  var id = _ref.id,
      name = _ref.name;
  var allocatedIds = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

  if (id) {
    return id;
  }

  var generated = name.replace(/\W+(.|$)/g, function (_, chr) {
    return chr.toUpperCase();
  });

  if (allocatedIds.indexOf(generated) >= 0) {
    _clientLogger.logger.warn("Story name conflict with exports - Please add an explicit id for story ".concat(name));

    generated += hashCode(name);
  }

  return generated;
}